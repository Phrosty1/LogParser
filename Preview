import re, pandas as pd, numpy as np, os, json
from io import StringIO
from IPython.core.display import display
import time # time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(1634309423832/1000))
eventSpecsFolder = os.path.realpath('../ESOUIDocumentation/')
rawLogFolder = os.path.realpath('../AnyLoggerRawLuaDumps/')
# eventDataFolder = 'C:/Beachhead/Misc/LogTinker/outdata/'
eventDataFolder = os.path.realpath('../Sandbox_Brian/EventData')
# eventDataFolder = os.path.realpath('C:\FolderToPutLogFiles\EsoAnalytics\Sandbox_Brian\EventData')
def getEventDataframe(event='EVENT_COMBAT_EVENT', days=0):
   if os.path.exists(eventDataFolder+'/'+event) :
      if days==0 : return pd.read_parquet(eventDataFolder+'/'+event)
      else : return pd.concat(pd.read_parquet(eventDataFolder+'/'+event+'/'+f) for f in [f for f in os.listdir(eventDataFolder+'/'+event) if f.endswith('.parquet')][-days:])
display(getEventDataframe(event='EVENT_COMBAT_EVENT', days=2))
